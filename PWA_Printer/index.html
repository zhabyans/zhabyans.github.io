<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PWA Thermal Printer</title>
</head>
<body>
  <h2>Thermal Printer via Web Bluetooth</h2>
  <button id="printBtn">Print "Hello Thermal!"</button>

  <script>
    const enc = new TextEncoder(); // buat ubah string jadi byte array

    document.getElementById("printBtn").addEventListener("click", async () => {
      try {
        // Pilih device printer bluetooth
        const device = await navigator.bluetooth.requestDevice({
          acceptAllDevices: true,
          optionalServices: [0x1101] // Serial Port Profile (SPP)
        });

        const server = await device.gatt.connect();

        // Biasanya printer thermal pakai "Serial over Bluetooth"
        // tapi tidak semua expose GATT service, jadi perlu dicek manual
        const service = await server.getPrimaryService(0x1101);
        const characteristic = await service.getCharacteristic(0xFFE1);

        // Data teks yang akan dicetak
        const data = enc.encode("Hello Thermal!\n\n\n");

        // Kirim ke printer
        await characteristic.writeValue(data);

        alert("Teks terkirim ke printer!");
      } catch (err) {
        console.error("Gagal koneksi:", err);
        alert("Tidak bisa konek ke printer. Cek dukungan Web Bluetooth & printer Anda.");
      }
    });
  </script>
</body>
</html>
